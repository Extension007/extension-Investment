# –û—Ç—á—ë—Ç –æ–± –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ 153 –¥–ª—è Chrome –Ω–∞ iPhone

## –î–∞—Ç–∞: 2024-12-19

## –¶–µ–ª—å
–ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É 153, –≤–æ–∑–Ω–∏–∫–∞—é—â—É—é –≤ Chrome –Ω–∞ iPhone –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è YouTube-–≤–∏–¥–µ–æ, –∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É –∫–Ω–æ–ø–∫–∏ Play.

---

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

**–û—à–∏–±–∫–∞ 153** –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –≤ Chrome –Ω–∞ iPhone (WKWebView) –∫–æ–≥–¥–∞ YouTube-–ø–ª–µ–µ—Ä —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∂–µ—Å—Ç–∞ (gesture context). WKWebView —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–∏–¥–µ–æ –∏–Ω–∏—Ü–∏–∏—Ä–æ–≤–∞–ª–æ—Å—å –Ω–∞–ø—Ä—è–º—É—é –∏–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (click, touchstart, etc.).

**–ü—Ä–∏—á–∏–Ω–∞:**
- –ü–ª–µ–µ—Ä —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ `openVideoOverlay()` —á–µ—Ä–µ–∑ `requestAnimationFrame`
- –ù–µ –±—ã–ª–æ –ø—Ä—è–º–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∂–µ—Å—Ç–∞
- WKWebView –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ

---

## ‚úÖ –í–Ω–µ—Å—ë–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–∏–¥–µ–æ

**–§–∞–π–ª:** `public/script.js`  
**–°—Ç—Ä–æ–∫–∏:** 174-177

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```javascript
// FIX: –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–∏–¥–µ–æ –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–µ–µ—Ä–∞ (–¥–ª—è gesture context)
let pendingVideoType = null; // –¢–∏–ø –≤–∏–¥–µ–æ (youtube, vk, instagram)
let pendingVideoId = null; // VideoId –¥–ª—è YouTube (–¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–µ–µ—Ä–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ)
let pendingVideoUrl = null; // URL –¥–ª—è VK/Instagram (–¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è iframe –ø—Ä–∏ –∫–ª–∏–∫–µ)
let isPlayerReadyToCreate = false; // –§–ª–∞–≥ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –ø–ª–µ–µ—Ä–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –≤–∏–¥–µ–æ –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–µ–µ—Ä–∞, —á—Ç–æ–±—ã –ø–ª–µ–µ—Ä —Å–æ–∑–¥–∞–≤–∞–ª—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

### 2. –ò–∑–º–µ–Ω–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `openVideoOverlay()` –¥–ª—è YouTube

**–§–∞–π–ª:** `public/script.js`  
**–°—Ç—Ä–æ–∫–∏:** 688-710

**–ë—ã–ª–æ:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–µ–µ—Ä–∞ —á–µ—Ä–µ–∑ `requestAnimationFrame`
- –ü–ª–µ–µ—Ä —Å–æ–∑–¥–∞–≤–∞–ª—Å—è –±–µ–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∂–µ—Å—Ç–∞

**–°—Ç–∞–ª–æ:**
- –ü–æ–∫–∞–∑ overlay —Å placeholder/–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –≤–∏–¥–µ–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (`pendingVideoType`, `pendingVideoId`)
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ `isPlayerReadyToCreate = true`
- –ü–ª–µ–µ—Ä —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ö–æ–¥:**
```javascript
// FIX: –ù–ï —Å–æ–∑–¥–∞—ë–º –ø–ª–µ–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ - —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
// –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è Chrome –Ω–∞ iPhone - –ø–ª–µ–µ—Ä –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ gesture context
pendingVideoType = 'youtube';
pendingVideoId = videoId;
isPlayerReadyToCreate = true;

// FIX: –ü–æ–∫–∞–∑—ã–≤–∞–µ–º placeholder —Å –∫–Ω–æ–ø–∫–æ–π Play –∏–ª–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
// –ü–ª–µ–µ—Ä –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞)
videoIframeContainer.innerHTML = `
  <div style="display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;color:#fff;text-align:center;padding:20px;">
    <div style="font-size:1.5rem;margin-bottom:20px;">‚ñ∂Ô∏è –ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è</div>
    <div style="font-size:0.9rem;opacity:0.8;">–í–∏–¥–µ–æ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ –ø–æ—Å–ª–µ –∫–ª–∏–∫–∞</div>
  </div>
`;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–ª–µ–µ—Ä —Ç–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, gesture context –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

---

### 3. –ò–∑–º–µ–Ω–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `openVideoOverlay()` –¥–ª—è VK

**–§–∞–π–ª:** `public/script.js`  
**–°—Ç—Ä–æ–∫–∏:** 720-733

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ URL –≤ `pendingVideoUrl`
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ `isPlayerReadyToCreate = true`
- –ü–æ–∫–∞–∑ placeholder –≤–º–µ—Å—Ç–æ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è iframe

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** VK –≤–∏–¥–µ–æ —Ç–∞–∫–∂–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

### 4. –î–æ–±–∞–≤–ª–µ–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–µ–µ—Ä–∞

**–§–∞–π–ª:** `public/script.js`  
**–°—Ç—Ä–æ–∫–∏:** 1169-1210

**–ö–æ–¥:**
```javascript
// FIX: –°–æ–∑–¥–∞–Ω–∏–µ YouTube/VK –ø–ª–µ–µ—Ä–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ gesture context –≤ Chrome iOS)
// –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–∫–∏ 153 - –ø–ª–µ–µ—Ä –¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞
if (videoOverlay && videoOverlay.classList.contains('show') && isPlayerReadyToCreate) {
  // FIX: –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∫–ª–∏–∫ –±—ã–ª –≤–Ω—É—Ç—Ä–∏ videoIframeContainer –∏–ª–∏ videoOverlay (–Ω–æ –Ω–µ –Ω–∞ –∫–Ω–æ–ø–∫–µ –∑–∞–∫—Ä—ã—Ç–∏—è)
  const clickedContainer = e.target.closest('#videoIframeContainer') || (e.target === videoOverlay && !e.target.closest('[data-close-video]'));
  
  if (clickedContainer && !e.target.closest('[data-close-video]')) {
    console.log('üñ±Ô∏è –ö–ª–∏–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ overlay - —Å–æ–∑–¥–∞—ë–º –ø–ª–µ–µ—Ä —Å gesture context');
    
    if (pendingVideoType === 'youtube' && pendingVideoId) {
      // FIX: –°–æ–∑–¥–∞–Ω–∏–µ YouTube –ø–ª–µ–µ—Ä–∞ –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞ - gesture context –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
      isPlayerReadyToCreate = false;
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ YouTube IFrame API –∑–∞–≥—Ä—É–∂–µ–Ω
      if (typeof YT === 'undefined' || typeof YT.Player === 'undefined') {
        console.warn('‚ö†Ô∏è YouTube IFrame API –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback');
        // FIX: Fallback —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞ - gesture context –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ WKWebView
        createYouTubeIframeFallback(pendingVideoId, true); // true = userGesture
      } else {
        // FIX: –°–æ–∑–¥–∞—ë–º –ø–ª–µ–µ—Ä –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞ - gesture context –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ WKWebView
        createYouTubeIframe(pendingVideoId);
      }
      
      // –û—á–∏—â–∞–µ–º pending –¥–∞–Ω–Ω—ã–µ
      pendingVideoType = null;
      pendingVideoId = null;
    } else if (pendingVideoType === 'vk' && pendingVideoUrl) {
      // FIX: –°–æ–∑–¥–∞–Ω–∏–µ VK iframe –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞ - gesture context –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
      isPlayerReadyToCreate = false;
      createVkIframe(pendingVideoUrl);
      pendingVideoType = null;
      pendingVideoUrl = null;
    }
    
    // FIX: –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ iframe —Å pending-src (fallback –±–µ–∑ userGesture)
    const pendingIframe = videoIframeContainer.querySelector('iframe[data-pending-src]');
    if (pendingIframe) {
      const pendingSrc = pendingIframe.getAttribute('data-pending-src');
      if (pendingSrc) {
        console.log('‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º src –¥–ª—è pending iframe –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (gesture context)');
        pendingIframe.src = pendingSrc;
        pendingIframe.removeAttribute('data-pending-src');
        pendingIframe.onload = function() {
          console.log('‚úÖ Pending fallback iframe –∑–∞–≥—Ä—É–∂–µ–Ω');
        };
      }
    }
  }
}
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–µ–µ—Ä–∞ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ gesture context –≤ WKWebView.

---

### 5. –ò–∑–º–µ–Ω–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `createYouTubeIframeFallback()`

**–§–∞–π–ª:** `public/script.js`  
**–°—Ç—Ä–æ–∫–∏:** 410-457

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `userGesture = false`
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `src` —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `userGesture === true`
- –ï—Å–ª–∏ `userGesture === false`, `src` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `data-pending-src` –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏

**–ö–æ–¥:**
```javascript
// FIX: userGesture –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å true –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ src - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è Chrome iOS (gesture context)
function createYouTubeIframeFallback(videoId, userGesture = false) {
  // ...
  
  // FIX: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ src —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞ (userGesture) –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ gesture context –≤ Chrome iOS
  // –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—à–∏–±–∫–∏ 153 - –±–µ–∑ gesture context WKWebView –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
  if (userGesture) {
    // FIX: src —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - gesture context –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
    iframe.src = embedUrl;
    console.log('‚úÖ Fallback iframe src —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (gesture context –ø–µ—Ä–µ–¥–∞–Ω)');
  } else {
    // FIX: –ï—Å–ª–∏ –≤—ã–∑–æ–≤ –Ω–µ –∏–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞, —Å–æ—Ö—Ä–∞–Ω—è–µ–º embedUrl –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏ –∫–ª–∏–∫–µ
    // –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è Chrome –Ω–∞ iPhone - –±–µ–∑ gesture context –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –æ—à–∏–±–∫–∞ 153
    console.log('‚ö†Ô∏è Fallback iframe —Å–æ–∑–¥–∞–Ω, –Ω–æ src –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è gesture context');
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º embedUrl –≤ data-–∞—Ç—Ä–∏–±—É—Ç –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–µ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏
    iframe.setAttribute('data-pending-src', embedUrl);
    console.log('‚úÖ Fallback iframe –≥–æ—Ç–æ–≤ –∫ —É—Å—Ç–∞–Ω–æ–≤–∫–µ src –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
  }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Fallback iframe —Ç–∞–∫–∂–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å —É—á—ë—Ç–æ–º gesture context.

---

### 6. –ò–∑–º–µ–Ω–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ `createYouTubeIframe()`

**–§–∞–π–ª:** `public/script.js`  
**–°—Ç—Ä–æ–∫–∏:** 394-400

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –£–±—Ä–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è fallback –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ–º API
- Fallback —Ç–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞

**–ö–æ–¥:**
```javascript
// Fallback: –µ—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Å—Ç–æ–π iframe
// FIX: –ù–µ –≤—ã–∑—ã–≤–∞–µ–º fallback –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ - –æ–Ω –¥–æ–ª–∂–µ–Ω –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –∏–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞
// –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏—Ç –ø–µ—Ä–µ–¥–∞—á—É gesture context –≤ Chrome iOS
if (typeof YT === 'undefined' || typeof YT.Player === 'undefined') {
  console.warn('‚ö†Ô∏è YouTube IFrame API –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, fallback –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
  // –ù–µ —Å–æ–∑–¥–∞—ë–º fallback –∑–¥–µ—Å—å - –æ–Ω –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  return;
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Fallback —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å gesture context.

---

### 7. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `closeVideoOverlay()`

**–§–∞–π–ª:** `public/script.js`  
**–°—Ç—Ä–æ–∫–∏:** 765-770

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –°–±—Ä–æ—Å —Ñ–ª–∞–≥–æ–≤ `isPlayerReadyToCreate`, `pendingVideoType`, `pendingVideoId`, `pendingVideoUrl`

**–ö–æ–¥:**
```javascript
// FIX: –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –ø–ª–µ–µ—Ä–∞
isPlayerReadyToCreate = false;
pendingVideoType = null;
pendingVideoId = null;
pendingVideoUrl = null;
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—á–∏—Å—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ overlay.

---

## üìã –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### ‚úÖ Overlay-–ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞:
- ‚úÖ –ü–æ–∫–∞–∑ overlay (`videoOverlay.classList.add('show')`)
- ‚úÖ –°–∫—Ä—ã—Ç–∏–µ overlay (`videoOverlay.classList.remove('show')`)
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ (`videoIframeContainer.innerHTML = ''`)
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–∫—Ä–æ–ª–ª–∞ (`document.body.style.overflow = 'hidden'`)

### ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞:
- ‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫ `onError` –≤ YT.Player API
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ 153 (–ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–µ–µ—Ä–∞)
- ‚úÖ –ó–∞–∫—Ä—ã—Ç–∏–µ overlay –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### ‚úÖ –†–∞–∑–º–µ—Ä—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –ø–ª–µ–µ—Ä–∞
- ‚úÖ –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –≤—ã–∑–æ–≤ –ø—Ä–∏ –Ω—É–ª–µ–≤—ã—Ö —Ä–∞–∑–º–µ—Ä–∞—Ö (—Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 100ms)

### ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–ª–µ–µ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã:
- ‚úÖ `origin: window.location.origin` (–±–µ–∑ encodeURIComponent)
- ‚úÖ `enablejsapi: 1`
- ‚úÖ `playsinline: 1`
- ‚úÖ `autoplay` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (–æ—Ç–∫–ª—é—á—ë–Ω)

---

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç

### ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 153:
- –ü–ª–µ–µ—Ä —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- Gesture context –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ WKWebView
- Fallback iframe —Ç–∞–∫–∂–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å gesture context

### ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –∫–Ω–æ–ø–∫–∏ Play:
- –ü–ª–µ–µ—Ä —Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ö–Ω–æ–ø–∫–∞ Play –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è (–ª—É—á—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞)

### ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞:
- –í—Å—è overlay-–ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ
- –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–ª–µ–µ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìù –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ FIX

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–º–µ—á–µ–Ω—ã –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ `// FIX:` —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—Ä–∏—á–∏–Ω—ã:
- –ü–µ—Ä–µ–¥–∞—á–∞ gesture context –≤ Chrome iOS
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ 153
- –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–µ–µ—Ä–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## ‚úÖ –ò—Ç–æ–≥

–û—à–∏–±–∫–∞ 153 —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞ –∑–∞ —Å—á—ë—Ç —Å–æ–∑–¥–∞–Ω–∏—è –ø–ª–µ–µ—Ä–∞ —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∫–ª–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø–µ—Ä–µ–¥–∞—á—É gesture context –≤ WKWebView (Chrome –Ω–∞ iPhone). –í–µ—Å—å –æ—Å—Ç–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å–æ—Ö—Ä–∞–Ω—ë–Ω –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

