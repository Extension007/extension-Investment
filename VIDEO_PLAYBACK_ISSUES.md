# –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –≤–∏–¥–µ–æ

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê #1: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–∫—Ä—ã—Ç –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ API

### –û–ø–∏—Å–∞–Ω–∏–µ:
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä `#videoFrame` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è **–≤–Ω—É—Ç—Ä–∏ –º–æ–¥–∞–ª–∫–∏**, –∫–æ—Ç–æ—Ä–∞—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–º–µ–µ—Ç `display: none`. YouTube IFrame API –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –ø–ª–µ–µ—Ä –≤ **—Å–∫—Ä—ã—Ç–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ**, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
- –ü–ª–µ–µ—Ä –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è
- –°–æ–±—ã—Ç–∏–µ `onReady` –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
- –û—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –Ω–∞ iOS Safari

### –¢–µ–∫—É—â–∏–π –∫–æ–¥:
```html
<div id="videoModal" class="modal" aria-hidden="true" style="display: none;">
  <div id="videoFrameContainer">
    <div id="videoFrame"></div> <!-- –°–∫—Ä—ã—Ç! -->
  </div>
</div>
```

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:
YouTube IFrame API —Ç—Ä–µ–±—É–µ—Ç **–≤–∏–¥–∏–º—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä** –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ `YT.Player`. –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–∫—Ä—ã—Ç (`display: none`), API –º–æ–∂–µ—Ç:
1. –ù–µ —Å–æ–∑–¥–∞—Ç—å iframe –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
2. –ù–µ –≤—ã–∑–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏–µ `onReady`
3. –ù–∞ iOS Safari —ç—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –∏–∑-–∑–∞ —Å—Ç—Ä–æ–≥–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

### –†–µ—à–µ–Ω–∏–µ:
–í—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (–Ω–µ–≤–∏–¥–∏–º–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è) –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ API:

```javascript
window.onYouTubeIframeAPIReady = function () {
  console.log("‚úÖ YouTube IFrame API –≥–æ—Ç–æ–≤");
  const videoFrame = document.getElementById('videoFrame');
  const modal = document.getElementById('videoModal');
  
  // –í—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª–∫—É –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
  const wasHidden = modal.style.display === 'none';
  if (wasHidden) {
    modal.style.display = 'block';
    modal.style.visibility = 'hidden';
    modal.style.position = 'absolute';
    modal.style.left = '-9999px';
  }
  
  player = new YT.Player('videoFrame', {
    width: '100%',
    height: '480',
    playerVars: { rel: 0, playsinline: 1 },
    events: {
      'onReady': onPlayerReady,
      'onError': (e) => console.error("‚ùå –û—à–∏–±–∫–∞ –ø–ª–µ–µ—Ä–∞:", e.data)
    }
  });
  
  // –°–∫—Ä—ã–≤–∞–µ–º –æ–±—Ä–∞—Ç–Ω–æ
  if (wasHidden) {
    setTimeout(() => {
      modal.style.display = 'none';
      modal.style.visibility = '';
      modal.style.position = '';
      modal.style.left = '';
    }, 100);
  }
};
```

---

## ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #2: –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å

### –û–ø–∏—Å–∞–Ω–∏–µ:
`document.querySelector('[data-close-video]')` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è **—Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∫—Ä–∏–ø—Ç–∞**, –Ω–æ —ç–ª–µ–º–µ–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ DOM, —á—Ç–æ –ø—Ä–∏–≤–µ–¥–µ—Ç –∫ –æ—à–∏–±–∫–µ `Cannot read property 'addEventListener' of null`.

### –¢–µ–∫—É—â–∏–π –∫–æ–¥:
```javascript
document.querySelector('[data-close-video]').addEventListener('click', () => {
  // ...
});
```

### –†–µ—à–µ–Ω–∏–µ:
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π:

```javascript
// –í–∞—Ä–∏–∞–Ω—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞
const closeBtn = document.querySelector('[data-close-video]');
if (closeBtn) {
  closeBtn.addEventListener('click', () => {
    // ...
  });
}

// –í–∞—Ä–∏–∞–Ω—Ç 2: –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–ª—É—á—à–µ)
document.addEventListener('click', (e) => {
  if (e.target.closest('[data-close-video]')) {
    const modal = document.getElementById('videoModal');
    modal.style.display = 'none';
    modal.setAttribute('aria-hidden', 'true');
    if (player && typeof player.stopVideo === 'function') {
      player.stopVideo();
      console.log("‚úÖ –í–∏–¥–µ–æ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ");
    }
  }
});
```

---

## ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #3: –ö–æ–Ω—Ñ–ª–∏–∫—Ç window.onYouTubeIframeAPIReady

### –û–ø–∏—Å–∞–Ω–∏–µ:
–í `cabinet.ejs` –∏ `admin.ejs` –µ—Å—Ç—å —Å–≤–æ–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è `window.onYouTubeIframeAPIReady`, –∫–æ—Ç–æ—Ä—ã–µ **–ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—é—Ç** –≥–ª–æ–±–∞–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–∑ `script.js`. –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫:
- –ù–∞ `index.ejs` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–π `player` –∏–∑ `script.js`
- –ù–∞ `cabinet.ejs` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–π `playerCabinet`
- –ù–∞ `admin.ejs` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–π `playerAdmin`
- –ù–æ –≤—Å–µ –æ–Ω–∏ –ø—ã—Ç–∞—é—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –ø–ª–µ–µ—Ä –≤ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ `#videoFrame`

### –¢–µ–∫—É—â–∏–π –∫–æ–¥:
- `public/script.js`: `window.onYouTubeIframeAPIReady` —Å–æ–∑–¥–∞–µ—Ç `player`
- `views/cabinet.ejs`: `window.onYouTubeIframeAPIReady` —Å–æ–∑–¥–∞–µ—Ç `playerCabinet`
- `views/admin.ejs`: `window.onYouTubeIframeAPIReady` —Å–æ–∑–¥–∞–µ—Ç `playerAdmin`

### –ü—Ä–æ–±–ª–µ–º–∞:
–ï—Å–ª–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `cabinet.ejs` –∏–ª–∏ `admin.ejs` –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏ `script.js`, –∏ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç, —Ç–æ –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç `window.onYouTubeIframeAPIReady`, –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø–ª–µ–µ—Ä –Ω–µ —Å–æ–∑–¥–∞—Å—Ç—Å—è.

### –†–µ—à–µ–Ω–∏–µ:
1. **–í–∞—Ä–∏–∞–Ω—Ç 1**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –≥–ª–æ–±–∞–ª—å–Ω—ã–π –ø–ª–µ–µ—Ä –≤–µ–∑–¥–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
2. **–í–∞—Ä–∏–∞–Ω—Ç 2**: –ü—Ä–æ–≤–µ—Ä—è—Ç—å, –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –ª–∏ —É–∂–µ `window.onYouTubeIframeAPIReady`:

```javascript
if (!window.onYouTubeIframeAPIReady) {
  window.onYouTubeIframeAPIReady = function() {
    // ...
  };
} else {
  // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞—Ä—É—é —Ñ—É–Ω–∫—Ü–∏—é –∏ –≤—ã–∑–≤–∞—Ç—å –æ–±–µ
  const oldFn = window.onYouTubeIframeAPIReady;
  window.onYouTubeIframeAPIReady = function() {
    oldFn();
    // –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞
  };
}
```

---

## ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #4: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤

### –û–ø–∏—Å–∞–Ω–∏–µ:
–í –∫–æ–¥–µ –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—à–∏–±–∫–∞–º.

### –¢–µ–∫—É—â–∏–π –∫–æ–¥:
```javascript
const modal = document.getElementById('videoModal');
modal.style.display = 'block'; // –ú–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å, –µ—Å–ª–∏ modal === null
```

### –†–µ—à–µ–Ω–∏–µ:
–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏:

```javascript
const modal = document.getElementById('videoModal');
if (!modal) {
  console.error("‚ùå –ú–æ–¥–∞–ª–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞");
  return;
}
modal.style.display = 'block';
```

---

## ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê #5: CSS –º–æ–∂–µ—Ç —Å–∫—Ä—ã–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

### –û–ø–∏—Å–∞–Ω–∏–µ:
CSS –ø—Ä–∞–≤–∏–ª–æ `#videoModal[aria-hidden="false"] #videoFrame` –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –º–æ–¥–∞–ª–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∞, –Ω–æ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ API –º–æ–¥–∞–ª–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞, –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫—Ä—ã—Ç.

### –¢–µ–∫—É—â–∏–π CSS:
```css
#videoModal[aria-hidden="false"] #videoFrame {
  display: block !important;
  visibility: visible !important;
  opacity: 1 !important;
  position: relative;
}
```

### –ü—Ä–æ–±–ª–µ–º–∞:
–ï—Å–ª–∏ –º–æ–¥–∞–ª–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞ (`aria-hidden="true"`), –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–∫—Ä—ã—Ç —á–µ—Ä–µ–∑ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ `display: none` –æ—Ç –º–æ–¥–∞–ª–∫–∏.

### –†–µ—à–µ–Ω–∏–µ:
–£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–∏–¥–∏–º –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—Å–º. –ü—Ä–æ–±–ª–µ–º—É #1).

---

## üìã –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

1. **–ö–†–ò–¢–ò–ß–ù–û**: –ü—Ä–æ–±–ª–µ–º–∞ #1 - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–∫—Ä—ã—Ç –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
2. **–í–ê–ñ–ù–û**: –ü—Ä–æ–±–ª–µ–º–∞ #2 - –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å
3. **–í–ê–ñ–ù–û**: –ü—Ä–æ–±–ª–µ–º–∞ #4 - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫
4. **–°–†–ï–î–ù–ï**: –ü—Ä–æ–±–ª–µ–º–∞ #3 - –ö–æ–Ω—Ñ–ª–∏–∫—Ç window.onYouTubeIframeAPIReady
5. **–ù–ò–ó–ö–û**: –ü—Ä–æ–±–ª–µ–º–∞ #5 - CSS (—Ä–µ—à–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ü—Ä–æ–±–ª–µ–º—É #1)

---

## ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

1. –í—Ä–µ–º–µ–Ω–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ API
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤
4. –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –ø–ª–µ–µ—Ä–∞ (–æ–¥–∏–Ω –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ)

