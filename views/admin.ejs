<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ê–¥–º–∏–Ω–∫–∞</title>
</head>
<body>
  <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h1>

  <form method="POST" action="/admin/product" enctype="multipart/form-data">
    <input type="text" name="name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" required>
    <input type="text" name="description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ">
    <input type="number" name="price" placeholder="–¶–µ–Ω–∞" required>
    <input type="url" name="link" placeholder="–°—Å—ã–ª–∫–∞" required>
    <input type="file" name="image" accept="image/*">

    <!-- ‚úÖ –ù–æ–≤–æ–µ –ø–æ–ª–µ –¥–ª—è —Å—Å—ã–ª–∫–∏ –Ω–∞ YouTube -->
    <input type="url" name="video_url" placeholder="–°—Å—ã–ª–∫–∞ –Ω–∞ YouTube –≤–∏–¥–µ–æ">

    <button type="submit">–î–æ–±–∞–≤–∏—Ç—å</button>
  </form>

  <h2>–°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤</h2>
  <% products.forEach(p => { %>
    <div style="margin: 10px 0; border-bottom: 1px solid #ccc; padding-bottom: 10px;">
      <strong><%= p.name %></strong> ‚Äî <%= p.price %> ‚Ç∏
      <% if (p.image_url) { %>
        <div>
          <img src="<%= p.image_url %>" alt="<%= p.name %>" style="max-width: 160px; height: auto;">
        </div>
      <% } %>

      <!-- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤–∏–¥–µ–æ, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å -->
      <% if (p.video_url) { %>
        <div>
          –í–∏–¥–µ–æ: <a href="<%= p.video_url %>" target="_blank" rel="noopener"><%= p.video_url %></a>
        </div>
      <% } %>

      <!-- üîπ –ë–ª–æ–∫ —Ä–µ–π—Ç–∏–Ω–≥–∞ –¥–ª—è –∞–¥–º–∏–Ω–∫–∏ -->
      <div class="product-rating" data-id="<%= p._id %>" style="margin-top: 5px;">
        <button class="like-btn" type="button" aria-label="–õ–∞–π–∫">üëç</button>

        <span class="result">
          <% const likes = p.likes || 0; %>
          <% const dislikes = p.dislikes || 0; %>
          <%= likes - dislikes %>
        </span>

        <button class="dislike-btn" type="button" aria-label="–î–∏–∑–ª–∞–π–∫">üëé</button>

        <span class="votes">
          (<%= (p.likes || 0) + (p.dislikes || 0) %> –≥–æ–ª–æ—Å–æ–≤)
        </span>
      </div>

      <div style="margin-top: 5px;">
        <a href="/admin/product/<%= p.id %>/edit">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
        <form method="POST" action="/admin/product/<%= p.id %>/delete" style="display:inline">
          <button type="submit">–£–¥–∞–ª–∏—Ç—å</button>
        </form>
      </div>
    </div>
  <% }) %>
</body>
</html>
